<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Gerador</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>

<style>
*{box-sizing:border-box}
body{
  background:#0b0e14;
  color:white;
  font-family:'Segoe UI',sans-serif;
  margin:0;
}

/* ===== TOPO ESTILO GEMINI ===== */
.topbar{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:60px;
  background:#0d1117;
  border-bottom:1px solid #30363d;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0 20px;
  z-index:100;
}

.user-info{
  display:flex;
  align-items:center;
  gap:10px;
}

.user-info img{
  width:36px;
  height:36px;
  border-radius:50%;
  border:1px solid #30363d;
  display:none;
}

.user-info span{
  color:#58a6ff;
  font-size:14px;
}

.topbar button{
  padding:8px 14px;
  border-radius:6px;
  border:none;
  font-weight:bold;
  cursor:pointer;
}

#loginBtn{background:#238636;color:white}
#logoutBtn{background:#da3633;color:white;display:none}

/* ===== CONTAINER ===== */
.container{
  background:#161b22;
  padding:30px;
  border-radius:12px;
  border:1px solid #30363d;
  width:450px;
  margin:100px auto 40px;
  display:none;
}

h2{text-align:center;color:#58a6ff}
label{font-size:12px;color:#8b949e;margin-top:10px;display:block}
input{
  width:100%;
  padding:12px;
  margin-top:5px;
  border-radius:6px;
  border:1px solid #30363d;
  background:#0d1117;
  color:white;
}

button.main{
  width:100%;
  padding:15px;
  margin-top:20px;
  border-radius:6px;
  border:none;
  background:#1f6feb;
  color:white;
  font-weight:bold;
  cursor:pointer;
}

#resultado{
  display:none;
  margin-top:20px;
  padding:15px;
  background:#0d1117;
  border:1px dashed #58a6ff;
  border-radius:6px;
}

#linkFinal{
  color:#58a6ff;
  font-size:13px;
  word-break:break-all;
  margin-bottom:10px;
}
</style>
</head>

<body>

<!-- ===== TOPO ===== -->
<div class="topbar">
  <div class="user-info">
    <img id="userPhoto">
    <span id="welcome">Bem-vindo</span>
  </div>
  <div>
    <button id="loginBtn" onclick="loginGoogle()">Entrar com Google</button>
    <button id="logoutBtn" onclick="logout()">Sair</button>
  </div>
</div>

<!-- ===== PAINEL ===== -->
<div class="container" id="painel">
<h2>Gerar Link Único</h2>

<label>Título da Versão</label>
<input id="tit" placeholder="Ex: Delta V702">

<label>Nome do Arquivo</label>
<input id="nom" placeholder="Ex: delta.apk">

<label>Tamanho</label>
<input id="tam" placeholder="Ex: 150 MB">

<label>Link de Download</label>
<input id="l_d">

<label>Link Botão Vermelho</label>
<input id="l_c">

<label>Link ou ID do Vídeo</label>
<input id="l_v">

<button class="main" onclick="gerarLinkCurto()">GERAR LINK</button>

<div id="resultado">
  <label>Link Final:</label>
  <div id="linkFinal"></div>
  <button class="main" onclick="copiarLink()">COPIAR</button>
</div>
</div>

<script>
// ===== FIREBASE CONFIG (TROQUE ISSO) =====
firebase.initializeApp({
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_PROJETO.firebaseapp.com",
  projectId: "SEU_PROJETO",
  appId: "SEU_APP_ID"
});

const auth = firebase.auth();
const provider = new firebase.auth.GoogleAuthProvider();

// LOGIN
function loginGoogle(){
  auth.signInWithPopup(provider);
}

// LOGOUT
function logout(){
  auth.signOut();
}

// CONTROLE LOGIN
auth.onAuthStateChanged(user=>{
  const photo = document.getElementById("userPhoto");

  if(user){
    document.getElementById("welcome").innerText =
      "Bem-vindo, " + user.displayName;

    if(user.photoURL){
      photo.src = user.photoURL;
      photo.style.display="block";
    }

    loginBtn.style.display="none";
    logoutBtn.style.display="inline-block";
    painel.style.display="block";
  }else{
    document.getElementById("welcome").innerText="Bem-vindo";
    photo.style.display="none";

    loginBtn.style.display="inline-block";
    logoutBtn.style.display="none";
    painel.style.display="none";
  }
});

// GERAR LINK
async function gerarLinkCurto(){
  let base = location.href.split('?')[0];
  let link =
    base.replace("index","concluir") +
    `?t=${encodeURIComponent(tit.value)}`+
    `&n=${encodeURIComponent(nom.value)}`+
    `&s=${encodeURIComponent(tam.value)}`+
    `&d=${encodeURIComponent(l_d.value)}`+
    `&c=${encodeURIComponent(l_c.value)}`+
    `&v=${encodeURIComponent(l_v.value)}`;

  try{
    const r = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(link)}`);
    linkFinal.innerText = await r.text();
  }catch{
    linkFinal.innerText = link;
  }
  resultado.style.display="block";
}

function copiarLink(){
  navigator.clipboard.writeText(linkFinal.innerText);
  alert("Link copiado!");
}
</script>

</body>
</html>
